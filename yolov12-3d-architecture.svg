<?xml version="1.0" encoding="UTF-8"?>
<svg width="1400" height="1000" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .title { font-family: Arial, sans-serif; font-size: 28px; font-weight: bold; fill: #2c3e50; }
      .subtitle { font-family: Arial, sans-serif; font-size: 16px; fill: #34495e; }
      .layer { font-family: Arial, sans-serif; font-size: 12px; fill: #2c3e50; }
      .output { font-family: Arial, sans-serif; font-size: 11px; fill: #fff; font-weight: bold; }
      .arrow { stroke: #3498db; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
      .arrow-thick { stroke: #3498db; stroke-width: 3; fill: none; marker-end: url(#arrowhead); }
      .box { stroke: #2c3e50; stroke-width: 2; rx: 8; }
      .input-box { fill: #3498db; }
      .backbone-box { fill: #9b59b6; }
      .neck-box { fill: #e67e22; }
      .head-box { fill: #e74c3c; }
      .output-box { fill: #27ae60; }
      .fusion-box { fill: #f39c12; }
      .dim-box { fill: #1abc9c; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#3498db" />
    </marker>
  </defs>

  <!-- Title -->
  <text x="700" y="40" text-anchor="middle" class="title">YOLOv12-3D Architecture</text>
  <text x="700" y="70" text-anchor="middle" class="subtitle">3D Object Detection for KITTI Dataset</text>

  <!-- Input -->
  <rect x="50" y="120" width="180" height="100" class="box input-box" />
  <text x="140" y="160" text-anchor="middle" class="output">Input Image</text>
  <text x="140" y="180" text-anchor="middle" class="layer">(640 × 640 × 3)</text>

  <!-- Backbone -->
  <rect x="300" y="90" width="200" height="160" class="box backbone-box" />
  <text x="400" y="120" text-anchor="middle" class="output">BACKBONE</text>
  <text x="400" y="145" text-anchor="middle" class="layer">YOLOv12 Features</text>
  <text x="400" y="165" text-anchor="middle" class="layer">- C3k2 blocks</text>
  <text x="400" y="185" text-anchor="middle" class="layer">- A2C2f blocks</text>
  <text x="400" y="205" text-anchor="middle" class="layer">- Upsampling layers</text>
  <text x="400" y="225" text-anchor="middle" class="layer">Feature Pyramid</text>

  <!-- Arrows from Input to Backbone -->
  <line x1="230" y1="170" x2="300" y2="170" class="arrow" />

  <!-- Neck -->
  <rect x="570" y="110" width="200" height="120" class="box neck-box" />
  <text x="670" y="140" text-anchor="middle" class="output">NECK</text>
  <text x="670" y="165" text-anchor="middle" class="layer">PAN (Path Aggregation)</text>
  <text x="670" y="185" text-anchor="middle" class="layer">Multi-scale Features</text>
  <text x="670" y="205" text-anchor="middle" class="layer">P3, P4, P5 outputs</text>

  <!-- Arrow from Backbone to Neck -->
  <line x1="500" y1="170" x2="570" y2="170" class="arrow" />

  <!-- Detect3D Head -->
  <rect x="840" y="80" width="220" height="200" class="box head-box" />
  <text x="950" y="115" text-anchor="middle" class="output">DETECT3D HEAD</text>
  <text x="950" y="140" text-anchor="middle" class="layer">3D Detection Output</text>

  <!-- Feature fusion -->
  <rect x="865" y="155" width="170" height="25" class="box fusion-box" />
  <text x="950" y="172" text-anchor="middle" class="layer" fill="#fff">Multi-scale Fusion</text>

  <!-- Arrows from Neck to Head -->
  <line x1="770" y1="150" x2="840" y2="150" class="arrow" />
  <line x1="770" y1="170" x2="840" y2="170" class="arrow" />
  <line x1="770" y1="190" x2="840" y2="190" class="arrow" />

  <!-- Output Layer -->
  <rect x="1120" y="80" width="230" height="260" class="box output-box" />
  <text x="1235" y="115" text-anchor="middle" class="output">OUTPUT LAYERS</text>

  <!-- 2D Detection Output -->
  <rect x="1140" y="130" width="190" height="40" class="box" fill="#2ecc71" />
  <text x="1235" y="150" text-anchor="middle" class="layer" fill="#fff">2D Detection</text>
  <text x="1235" y="167" text-anchor="middle" class="layer" fill="#fff">Box (x, y, w, h)</text>

  <!-- 3D Location Output -->
  <rect x="1140" y="180" width="190" height="40" class="box dim-box" />
  <text x="1235" y="200" text-anchor="middle" class="layer" fill="#fff">3D Location</text>
  <text x="1235" y="217" text-anchor="middle" class="layer" fill="#fff">(x, y, z)</text>

  <!-- 3D Dimensions Output -->
  <rect x="1140" y="230" width="190" height="40" class="box dim-box" />
  <text x="1235" y="250" text-anchor="middle" class="layer" fill="#fff">3D Dimensions</text>
  <text x="1235" y="267" text-anchor="middle" class="layer" fill="#fff">(h, w, l)</text>

  <!-- Rotation Output -->
  <rect x="1140" y="280" width="190" height="40" class="box dim-box" />
  <text x="1235" y="300" text-anchor="middle" class="layer" fill="#fff">Rotation</text>
  <text x="1235" y="317" text-anchor="middle" class="layer" fill="#fff">Yaw angle (θ)</text>

  <!-- Class Output -->
  <rect x="1140" y="330" width="190" height="30" class="box" fill="#16a085" />
  <text x="1235" y="348" text-anchor="middle" class="layer" fill="#fff">Class (Car, Pedestrian, etc.)</text>

  <!-- Arrow from Head to Output -->
  <line x1="1060" y1="180" x2="1120" y2="180" class="arrow-thick" />

  <!-- Prediction Example Box -->
  <rect x="50" y="380" width="1300" height="220" class="box" fill="#ecf0f1" stroke="#95a5a6" stroke-width="3" />
  <text x="700" y="415" text-anchor="middle" class="subtitle" font-size="18" font-weight="bold">Example Prediction Output</text>

  <!-- Example 1 -->
  <rect x="100" y="440" width="550" height="140" class="box" fill="#3498db" opacity="0.3" />
  <text x="375" y="465" text-anchor="middle" class="layer" font-size="14" font-weight="bold">Detection 1: Car</text>
  <text x="110" y="490" class="layer">2D Box: [x1, y1, x2, y2]</text>
  <text x="110" y="510" class="layer">3D Location: [2.4m, 1.5m, 35.2m]</text>
  <text x="110" y="530" class="layer">3D Dimensions: [1.65m, 1.67m, 3.64m]</text>
  <text x="110" y="550" class="layer">Rotation: -0.65 radians</text>
  <text x="110" y="570" class="layer">Confidence: 0.89</text>

  <!-- Example 2 -->
  <rect x="700" y="440" width="550" height="140" class="box" fill="#3498db" opacity="0.3" />
  <text x="975" y="465" text-anchor="middle" class="layer" font-size="14" font-weight="bold">Detection 2: Pedestrian</text>
  <text x="710" y="490" class="layer">2D Box: [x1, y1, x2, y2]</text>
  <text x="710" y="510" class="layer">3D Location: [-1.2m, 0.9m, 18.5m]</text>
  <text x="710" y="530" class="layer">3D Dimensions: [1.75m, 0.65m, 0.85m]</text>
  <text x="710" y="550" class="layer">Rotation: 0.12 radians</text>
  <text x="710" y="570" class="layer">Confidence: 0.76</text>

  <!-- Loss Functions -->
  <rect x="50" y="640" width="1300" height="320" class="box" fill="#f8f9fa" stroke="#6c757d" stroke-width="2" />
  <text x="700" y="675" text-anchor="middle" class="subtitle" font-size="18" font-weight="bold">Loss Functions</text>

  <!-- Loss components -->
  <rect x="100" y="700" width="280" height="240" class="box" fill="#e8f5e9" />
  <text x="240" y="725" text-anchor="middle" class="layer" font-size="14" font-weight="bold">2D Detection Loss</text>
  <text x="110" y="750" class="layer">• box_loss (IoU Loss)</text>
  <text x="110" y="770" class="layer">• cls_loss (BCE)</text>
  <text x="110" y="790" class="layer">• dfl_loss (Dist. Focal)</text>

  <rect x="410" y="700" width="280" height="240" class="box" fill="#e3f2fd" />
  <text x="550" y="725" text-anchor="middle" class="layer" font-size="14" font-weight="bold">3D Location Loss</text>
  <text x="420" y="750" class="layer">• loc_x_loss (L1)</text>
  <text x="420" y="770" class="layer">• loc_y_loss (L1)</text>
  <text x="420" y="790" class="layer">• depth_loss (L1)</text>

  <rect x="720" y="700" width="280" height="240" class="box" fill="#fff3e0" />
  <text x="860" y="725" text-anchor="middle" class="layer" font-size="14" font-weight="bold">3D Shape &amp; Rotation</text>
  <text x="730" y="750" class="layer">• dim_loss (L1)</text>
  <text x="730" y="770" class="layer">• rot_loss (Smooth L1)</text>
  <text x="730" y="790" class="layer">• sin/cos encoding</text>

  <rect x="1030" y="700" width="280" height="240" class="box" fill="#f3e5f5" />
  <text x="1170" y="725" text-anchor="middle" class="layer" font-size="14" font-weight="bold">Total Loss</text>
  <text x="1040" y="770" class="layer" font-size="16">= box + cls + dfl</text>
  <text x="1040" y="800" class="layer" font-size="16">  + loc_x + loc_y + depth</text>
  <text x="1040" y="830" class="layer" font-size="16">  + dim + rot</text>

  <!-- Model Parameters -->
  <rect x="50" y="980" width="1300" height="140" class="box" fill="#fffde7" stroke="#fbc02d" stroke-width="2" />
  <text x="700" y="1010" text-anchor="middle" class="subtitle" font-size="18" font-weight="bold">Model Variants (KITTI 3D Detection)</text>
  <text x="120" y="1040" class="layer" font-size="13">YOLOv12n-3D: 2.6M params • Speed: ⚡⚡⚡⚡⚡ • mAP: ~30%</text>
  <text x="120" y="1065" class="layer" font-size="13">YOLOv12s-3D: 9.1M params • Speed: ⚡⚡⚡⚡ • mAP: ~35%</text>
  <text x="120" y="1090" class="layer" font-size="13">YOLOv12m-3D: 19.7M params • Speed: ⚡⚡⚡ • mAP: ~40%</text>
  <text x="120" y="1115" class="layer" font-size="13">YOLOv12l-3D: 26.5M params • Speed: ⚡⚡ • mAP: ~42%</text>
</svg>
